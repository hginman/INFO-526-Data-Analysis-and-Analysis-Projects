---
title: "Viz2 Basic Plots"
author: "Hayden Ginman"
date: "2023-09-05"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


Step 1 - Load libraries into coding environment
```{r}
options(repos = c(CRAN = "https://cloud.r-project.org/"))
#install.packages("lubridate")
#install.packages("viridis")
library("dplyr")
library("reshape2")
library("ggplot2")
library("lubridate")
library("viridis")

```

Step 2 - Load clean data into coding environment - Use lubridate to convert character dates to functional format

```{r}
vaccinations <- read.csv("COVID-19_Vaccinations_by_Age_(Maricopa_County).csv")

vaccinations$StartDate <- as.Date(substr(vaccinations$StartDate, 1, 10), format="%Y/%m/%d")
vaccinations$Month <- format(vaccinations$StartDate, "%Y-%m")


```

Step 3 - 

```{r}
monthly_vaccinations <- vaccinations %>%
  group_by(Month) %>%
  summarize(
    Age0To14 = sum(VaccinatedAge0To14, na.rm = TRUE),
    Age15To24 = sum(VaccinatedAge15To24, na.rm = TRUE),
    Age25To34 = sum(VaccinatedAge25To34, na.rm = TRUE),
    Age35To44 = sum(VaccinatedAge35To44, na.rm = TRUE),
    Age45To54 = sum(VaccinatedAge45To54, na.rm = TRUE),
    Age55To64 = sum(VaccinatedAge55To64, na.rm = TRUE),
    Age65To74 = sum(VaccinatedAge65To74, na.rm = TRUE),
    Age75Up = sum(VaccinatedAge75Up, na.rm = TRUE)
  )

```

Step 4 - 

```{r}
melt_monthly_vax <- melt(monthly_vaccinations, id.vars = "Month")

melt_monthly_vax$Month <- as.Date(paste0(melt_monthly_vax$Month, "-01"), format="%Y-%m-%d")

age_labels <- c(
  Age0To14 = "0-14 years",
  Age15To24 = "15-24 years",
  Age25To34 = "25-34 years",
  Age35To44 = "35-44 years",
  Age45To54 = "45-54 years",
  Age55To64 = "55-64 years",
  Age65To74 = "65-74 years",
  Age75Up = "75+ years"
)


ggplot(melt_monthly_vax, aes(x = Month, y = value, fill = variable, group = variable)) +
  geom_area(position = "stack", alpha = 0.7) +
  labs(title = "Monthly Vaccinations in Maricopa County by Age Group",
       x = "Month",
       y = "Number of Vaccinations",
       fill = "Age Group",
       caption = "Data source: Maricopa County Health Department") +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  scale_y_continuous(breaks = seq(0, 30000000, by = 2000000), labels = function(x) format(x, big.mark = ",", scientific = FALSE)) + scale_fill_viridis_d(breaks = names(age_labels), labels = age_labels) + theme_minimal()


ggplot(melt_monthly_vax, aes(x = Month, y = value, fill = variable, group = variable)) +
  geom_area(position = "stack", alpha = 0.7) +
  labs(title = "Monthly Vaccinations in Maricopa County by Age Group",
       x = "Month",
       y = "Number of Vaccinations",
       fill = "Age Group") +
  scale_y_continuous(breaks = seq(0, max(melt_monthly_vax$value, na.rm = TRUE), by = 250000),
                     labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  theme_minimal()



ggplot(melt_monthly_vax, aes(x = Month, y = value, color = variable, group = variable)) +
  geom_line() +
  labs(title = "Monthly Vaccinations in Maricopa County by Age Group",
       x = "Month",
       y = "Number of Vaccinations",
       color = "Age Group") +
  scale_y_continuous(breaks = seq(0, max(melt_monthly_vax$value, na.rm = TRUE), by = 250000),
                     labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
  scale_x_date(date_breaks = "1 month", date_labels = "%b") +
  theme_minimal()


```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
